#include "tfidf2.hpp"
std::string doc1 =
    "In this paper, a natural generalization of KMY model is proposed for the evaporation of "
    "charged black holes. Within the proposed model, the back reaction of Hawking radiation is "
    "considered. More specifically, we consider the equation Gμν=8π⟨Tμν⟩, in which the matter "
    "content ⟨Tμν⟩ is assumed spherically symmetric. With this equation of motion, the asymptotic "
    "behavior of the model is analyzed. Two kinds of matter contents are taken into consideration "
    "in this paper. In the first case (the thin-shell model), the infalling matter is simulated by "
    "a null-like charged sphere collapsing into its center. In the second case, we consider a "
    "continuous distribution of spherical symmetric infalling null-like charged matter. It is "
    "simulated by taking the continuous limit of many co-centric spheres collapsing into the "
    "center. We find that in the thin-shell case, an event horizon forms and the shell passes "
    "through the horizon before becoming extremal, provided that it is not initially "
    "near-extremal. In the case of continuous matter distribution, we consider explicitly an "
    "extremal center covered by neutral infalling matter and find that the event horizon also "
    "forms. The black hole itself will become near-extremal eventually, leaving possibly a "
    "non-electromagnetic energy residue less than the order of ℓ4p/e30. The details of the "
    "behavior of these models are explicitly worked out in this paper.";
std::string doc2 =
    "We explore the stress-energy tensor arising from the interaction of U(1) symmetric quantum "
    "and gravitational fields. Using scalar-tensor theories of gravity, a conformal factor Ω2 is "
    "defined as the rest mass corrected by the quantum potential. The quantum potential, derived "
    "from the Klein-Gordon equation, allows for matter's intrinsic interaction with spacetime. A "
    "Lagrange multiplier λ is used as a constraint to properly couple matter with gravity. The "
    "Heisenberg uncertainty principle appears as a natural artifact of λ. Unlike the classical "
    "limit, λ in the quantum regime strongly influence the stress-energy tensor and it is "
    "therefore suggested that it is characteristic of the quantum vacuum. Additionally, the "
    "cosmological constant Λ, defined from the modified Einstein's equation, is formulated for any "
    "particle of mass m. The mysterious variation in Λ is properly evaluated from its cosmological "
    "value to that of an electron, from which we obtained a 77 order difference.";
std::string doc3 =
    "We study the flight time fluctuations in an anisotropic medium inspired by a cosmic string "
    "with an effective fluctuating refractive index caused by fluctuating vacuum electric fields, "
    "which are analogous to the lightcone fluctuations due to fluctuating spacetime metric when "
    "gravity is quantized. The medium can be realized as a metamaterial that mimics a cosmic "
    "string in the sense of transformation optics. For a probe light close to the analogue string, "
    "the flight time variance is ν times that in a normal homogeneous and isotropic medium, where "
    "ν is a parameter characterizing the deficit angle of the spacetime of a cosmic string. The "
    "parameter ν, which is always greater than unity for a real cosmic string, is determined by "
    "the dielectric properties of the metamaterial for an analogue string. Therefore, the flight "
    "time fluctuations of a probe light can be manipulated by changing the electric permittivity "
    "and magnetic permeability of the analogue medium. We argue that it seems possible to "
    "fabricate a metamaterial that mimics a cosmic string with a large ν in laboratory so that a "
    "currently observable flight time variance might be achieved.";
std::string doc4 =
    "The existence of a minimal measurable length as a characteristic length in the Planck scale "
    "is one of the main features of quantum gravity and has been widely explored in the context. "
    "Various different deformations of spacetime have been employed successfully for the purpose. "
    "However, polymer quantization approach is a relatively new and dynamic field towards the "
    "quantum gravity phenomenology, which emerges from the symmetric sector of the loop quantum "
    "gravity. In this article, we extend the standard ideas of polymer quantization to find a new "
    "and tighter bound on the polymer deformation parameter. Our protocol relies on an "
    "opto-mechanical experimental setup that was originally proposed in Ref.\cite{ref:Igor} to "
    "explore some interesting phenomena by embedding the minimal length into the standard "
    "canonical commutation relation. We extend this scheme to probe the \emph{polymer length} "
    "deformed canonical commutation relation of the center of mass mode of a mechanical oscillator "
    "with a mass around the Planck scale. The method utilizes the novelty of exchanging the "
    "relevant mechanical information with a high intensity optical pulse inside an optical cavity. "
    "We also demonstrate that our proposal is within the reach of the current technologies and, "
    "thus, it could uncover a decent realization of quantum gravitational phenomena thorough a "
    "simple table-top experiment.";
std::string doc5 =
    "The action of the field theory is a generating functional for the equations of physics. It is "
    "introduced axiomatically by the kernel of the evolution equation. Mathematical consistency "
    "requires the lower limit of the defining proper time integral have an arbitrary positive "
    "value. This limit introduces into the dimensionless field theory the physical scale (the "
    "characteristic length), which relates geometrical orders of the action. The action is finite "
    "in all orders and nonlocal starting from the second order. Its two lowest (local) orders "
    "correspond to the cosmological constant term and the Einstein-Hilbert action of gravitation "
    "that confirm the Sakharov-DeWitt mechanism of the induced gravity. No absolute values of "
    "physical quantities are special in the field theory, therefore, the Planck scale (the Planck "
    "length etc) has no physical significance, as elucidated by the New SI of physical units. It "
    "is shown that the dimensional regularization technique is an ill-defined procedure, while "
    "regularization and renormalization are not needed for phenomenological physical theories.";
std::string doc6 =
    "We introduce a new type of van Hove singularity in two dimensions, where a saddle point in "
    "momentum space is changed from second-order to high-order. Correspondingly, the density of "
    "states near such high-order van Hove singularity is significantly enhanced from logarithmic "
    "to power-law divergence, which promises stronger electronic correlation. High-order van Hove "
    "singularity can be generally achieved by tuning the band structure with a single parameter in "
    "moiré superlattices, such as tuning twist angle or applying pressure in twisted bilayer "
    "graphene.";
std::string doc7 =
    "A t52g system with a honeycomb lattice structure such as Na2IrO3 was firstly proposed as a "
    "topological insulator even though Na2IrO3 and its isostructural materials in nature have been "
    "turned out to be a Mott insulator with magnetic order. Here we theoretically revisit the "
    "topological property based on a minimal tight-binding Hamiltonian for three t2g bands "
    "incorporating a strong spin orbit coupling and two types of the first nearest neighbor (NN) "
    "hopping channel between transition metal ions, i.e., the hopping (t1) mediated by edge-shared "
    "ligands and the direct hopping (t′1) between t2g orbitals via ddσ bonding. We demonstrate "
    "that the topological phase transition takes place by varying only these hopping parameters "
    "with the relative strength parametrized by θ, i.e., t1=tcosθ and t′1=tsinθ. We also explore "
    "the effect of the second and third NN hopping channels, and the trigonal distortion on the "
    "topological phase for the whole range of θ. Furthermore, we examine the electronic and "
    "topological phases in the presence of on-site Coulomb repulsion U. Employing the cluster "
    "perturbation theory, we show that, with increasing U, a trivial or topological band insulator "
    "in the absence of U can be transferred into a Mott insulator with nontrivial or trivial band "
    "topology. We briefly discuss the relevance of our results to the existing materials.";
std::string doc8 =
    "We study the real time dynamics of NF flavors of fermions coupled to a U(1) gauge field in "
    "2+1 dimensions to leading order in a 1/NF expansion. For large enough NF, this is an "
    "interacting conformal field theory and describes the low energy properties of the Dirac spin "
    "liquid. We focus on thermalization and the onset of many-body quantum chaos which can be "
    "diagnosed from the growth of initally anti-commuting fermion field operators. We compute such "
    "anti-commutators in this gauge theory to leading order in 1/NF. We find that the "
    "anti-commutator grows exponentially in time and compute the quantum Lyapunov exponent. We "
    "briefly comment on chaos, locality, and gauge invariance.";
std::string doc9 =
    "Understanding the mechanism of high temperature (high Tc) superconductivity is a central "
    "problem in condensed matter physics. It is often speculated that high Tc superconductivity "
    "arises from a doped Mott insulator as described by the Hubbard model. An exact solution of "
    "the Hubbard model, however, is extremely challenging due to the strong electron-electron "
    "correlation. Therefore, it is highly desirable to experimentally study a model Hubbard system "
    "in which the unconventional superconductivity can be continuously tuned by varying the "
    "Hubbard parameters. Here we report signatures of tunable superconductivity in ABC-trilayer "
    "graphene (TLG) / boron nitride (hBN) moiré superlattice. Unlike magic angle twisted bilayer "
    "graphene, theoretical calculations show that under a vertical displacement field the "
    "ABC-TLG/hBN heterostructure features an isolated flat valence miniband associated with a "
    "Hubbard model on a triangular superlattice. Upon applying such a displacement field we find "
    "experimentally that the ABC-TLG/hBN superlattice displays Mott insulating states below 20 "
    "Kelvin at 1/4 and 1/2 fillings, corresponding to 1 and 2 holes per unit cell, respectively. "
    "Upon further cooling, signatures of superconducting domes emerge below 1 kelvin for the "
    "electron- and hole-doped sides of the 1/4 filling Mott state. The electronic behavior in the "
    "TLG/hBN superlattice is expected to depend sensitively on the interplay between the "
    "electron-electron interaction and the miniband bandwidth, which can be tuned continuously "
    "with the displacement field D. By simply varying the D field, we demonstrate transitions from "
    "the candidate superconductor to Mott insulator and metallic phases. Our study shows that "
    "TLG/hBN heterostructures offer an attractive model system to explore rich correlated behavior "
    "emerging in the tunable triangular Hubbard model.";
std::string doc10 =
    "In a many-body quantum system, local operators in Heisenberg picture O(t)=eiHtOe−iHt spread "
    "as time increases. Recent studies have attempted to find features of that spreading which "
    "could distinguish between chaotic and integrable dynamics. The operator entanglement - the "
    "entanglement entropy in operator space - is a natural candidate to provide such a "
    "distinction. Indeed, while it is believed that the operator entanglement grows linearly with "
    "time t in chaotic systems, numerics suggests that it grows only logarithmically in integrable "
    "systems. That logarithmic growth has already been established for non-interacting fermions, "
    "however progress on interacting integrable systems has proved very difficult. Here, for the "
    "first time, a logarithmic upper bound is established rigorously for all local operators in "
    "such a system: the `Rule 54' qubit chain, a model of cellular automaton introduced in the "
    "1990s [Bobenko et al., CMP 158, 127 (1993)], recently advertised as the simplest "
    "representative of interacting integrable systems. Physically, the logarithmic bound "
    "originates from the fact that the dynamics of the models is mapped onto the one of stable "
    "quasiparticles that scatter elastically; the possibility of generalizing this scenario to "
    "other interacting integrable systems is briefly discussed.";
std::string doc11 =
    "Quantum spin systems such as magnetic insulators usually show classical magnetic order, but "
    "such classical states can give way to quantum liquids with exotic entanglement through two "
    "known mechanisms of frustration: geometric frustration in lattices with triangle motifs, and "
    "spin-orbit-coupling frustration in the exactly solvable quantum liquid of Kitaev's honeycomb "
    "lattice. Here we present the experimental observation of a new kind of frustrated quantum "
    "liquid arising in an unlikely place: the magnetic insulator Ba4Ir3O10 where Ir3O12 trimers "
    "form an unfrustrated square lattice. Experimentally we find a quantum liquid state persisting "
    "down to 0.2 K that is stabilized by strong antiferromagnetic interaction with Curie-Weiss "
    "temperature - 766 K. The astonishing frustration parameter of 3800 is beyond any known "
    "iridate thus far. Heat capacity and thermal conductivity are both linear at low temperatures, "
    "a familiar feature in metals but here in an insulator pointing to an exotic quantum liquid "
    "state. A mere 2% Sr substitution for Ba produces long-range order at 130 K and destroys the "
    "linear-T features. Although the Ir4+(5d5) ions in Ba4Ir3O10 appear to form Ir3O12 trimers of "
    "face-sharing IrO6 octahedra, we propose that intra-trimer exchange is reduced and the lattice "
    "recombines into an array of coupled 1D chains with additional spins. An extreme limit of "
    "decoupled 1D chains can explain most but not all of the striking experimental observations, "
    "indicating that the inter-chain coupling plays an important role in the novel frustration "
    "mechanism leading to this quantum liquid.";
std::string doc12 =
    "Recent experiments on magic-angle twisted bilayer graphene have discovered correlated "
    "insulating behavior and superconductivity at a fractional filling of an isolated narrow band. "
    "In this paper we show that magic-angle bilayer graphene exhibits another hallmark of strongly "
    "correlated systems --- a broad regime of T−linear resistivity above a small, density "
    "dependent, crossover temperature--- for a range of fillings near the correlated insulator. We "
    "also extract a transport scattering rate, which satisfies a near Planckian form that is "
    "universally related to the ratio of (kBT/ℏ). Our results establish magic-angle bilayer "
    "graphene as a highly tunable platform to investigate strange metal behavior, which could shed "
    "light on this mysterious ubiquitous phase of correlated matter.";
std::string doc13 =
    "We study a generalization of the chaos bound that applies to out-of-time-ordered correlators "
    "between four different operators. We prove this bound under the same assumptions that apply "
    "for the usual chaos bound and extend it to non-hermitian operators. In a holographic theory, "
    "these correlators are controlled by inelastic scattering in the bulk and we comment on "
    "implications. In particular, for holographic theories the bound together with the equivalence "
    "principle suggests that gravity is the highest spin force, and the strongest one with that "
    "spin.";
std::string doc14 =
    "This paper provides new insights into the problem of selecting filter center frequencies for "
    "the auditory filterbanks. We propose to use a constant frequency distance and a consistent "
    "frequency coverage as the two metrics that motivate the logarithmic frequency scaling and a "
    "regularized selection of center frequencies. The frequency scaling and the consistent "
    "frequency coverage have been derived based on a common harmonic speaker signal model. "
    "Furthermore, we have found that the existing linear equivalent rectangular bandwidth (ERB) "
    "function as well as any possible linear ERB approximation can also lead to a consistent "
    "frequency coverage. The results are verified and demonstrated using the gammatone filterbank.";
std::string doc15 =
    "Directional modulation (DM) is a physical layer security technique based on antenna arrays "
    "and so far the polarisation information has not been considered in its designs. To increase "
    "the channel capacity, we consider exploiting the polarisation information and send two "
    "different signals simultaneously at the same direction, same frequency, but with different "
    "polarisations. These two signals can also be considered as one composite signal using the "
    "four dimensional (4-D) modulation scheme across the two polarisation diversity channels. In "
    "this paper, based on cross-dipole arrays, we formulate the design to find a set of common "
    "weight coefficients to achieve directional modulation for such a composite signal and "
    "examples are provided to verify the effectiveness of the proposed method.";
std::string doc16 =
    "One of the fundamental challenges affecting the performance of communication systems is the "
    "undesired impact of noise on a signal. Noise distorts the signal and originates due to "
    "several sources including, system non-linearity and noise interference from adjacent "
    "environment. Conventional communication systems use filters to cancel noise in a received "
    "signal. In the case of cognitive radio systems, denoising a signal is important during the "
    "spectrum sensing period, and also during communication with other network nodes. Based on our "
    "findings, few surveys are found that only review particular denoising techniques employed for "
    "the spectrum sensing phase of cognitive radio communication. This paper aims to provide a "
    "collective review of denoising techniques that can be applied to a cognitive radio system "
    "during all the phases of cognitive communication and discusses several works where the "
    "denoising techniques are employed. To establish comprehensive overview, a performance "
    "comparison of the discussed denoising techniques are also provided.";
std::string doc17 =
    "In this paper, a Poisson multi-Bernoulli (PMB) filter for multiple extended targets "
    "estimation is presented. The PMB filter is based on the Poisson multi-Bernoulli mixture "
    "(PMBM) conjugate prior and approximates the multi-Bernoulli mixture (MBM) in the posterior as "
    "a single multi-Bernoulli. By only having a single multi-Bernoulli representing detected "
    "targets in the posterior, the computational cost due to the data association problem can be "
    "effectively reduced. Different methods to merge the MBM are presented, along with their gamma "
    "Gaussian inverse Wishart implementations. The performance of the PMB filter is compared to "
    "the PMBM filter in different simulated scenarios.";
std::string doc18 =
    "A novel joint symbol timing and carrier frequency offset (CFO) estimation algorithm is "
    "proposed for reduced-guard-interval coherent optical orthogonal frequency-division "
    "multiplexing (RGI-CO-OFDM) systems. The proposed algorithm is based on a constant amplitude "
    "zero autocorrelation (CAZAC) sequence weighted by a pseudo-random noise (PN) sequence. The "
    "symbol timing is accomplished by using only one training symbol of two identical halves, with "
    "the weighting applied to the second half. The special structure of the training symbol is "
    "also utilized in estimating the CFO. The performance of the proposed algorithm is "
    "demonstrated by means of numerical simulations in a 115.8-Gb/s 16-QAM RGI-CO-OFDM system.";
std::string doc19 =
    "In recent years, there has been a dramatic increase in the use of unmanned aerial vehicles "
    "(UAVs), particularly for small UAVs, due to their affordable prices, ease of availability, "
    "and ease of operability. Existing and future applications of UAVs include remote surveillance "
    "and monitoring, relief operations, package delivery, and communication backhaul "
    "infrastructure. Additionally, UAVs are envisioned as an important component of 5G wireless "
    "technology and beyond. The unique application scenarios for UAVs necessitate accurate "
    "air-to-ground (AG) propagation channel models for designing and evaluating UAV communication "
    "links for control/non-payload as well as payload data transmissions. These AG propagation "
    "models have not been investigated in detail when compared to terrestrial propagation models. "
    "In this paper, a comprehensive survey is provided on available AG channel measurement "
    "campaigns, large and small scale fading channel models, their limitations, and future "
    "research directions for UAV communication scenarios.";
std::string doc20 =
    "A generic computational imaging setup is considered which assumes sequential illumination of "
    "a semi-transparent object by an arbitrary set of structured illumination patterns. For each "
    "incident illumination pattern, all transmitted light is collected by a photon-counting bucket "
    "(single-pixel) detector. The transmission coefficients measured in this way are then used to "
    "reconstruct the spatial distribution of the object's projected transmission. It is "
    "demonstrated that the squared spatial resolution of such a setup is usually equal to the "
    "ratio of the image area to the number of linearly independent illumination patterns. If the "
    "noise in the measured transmission coefficients is dominated by photon shot noise, then the "
    "ratio of the spatially-averaged squared mean signal to the spatially-averaged noise variance "
    "in the flat distribution reconstructed in the absence of the object, is equal to the average "
    "number of registered photons when the illumination patterns are orthogonal. The "
    "signal-to-noise ratio in a reconstructed transmission distribution is always lower in the "
    "case of non-orthogonal illumination patterns due to spatial correlations in the measured "
    "data. Examples of imaging methods relevant to the presented analysis include conventional "
    "imaging with a pixelated detector, computational ghost imaging, compressive sensing, "
    "super-resolution imaging and computed tomography.";

std::vector<std::pair<std::string, std::string>> source = {
    make_pair("1", doc1),   make_pair("2", doc2),   make_pair("3", doc3),   make_pair("4", doc4),
    make_pair("5", doc5),   make_pair("6", doc6),   make_pair("7", doc7),   make_pair("8", doc8),
    make_pair("9", doc9),   make_pair("10", doc10), make_pair("11", doc11), make_pair("12", doc12),
    make_pair("13", doc13), make_pair("14", doc14), make_pair("15", doc15), make_pair("16", doc16),
    make_pair("17", doc17), make_pair("18", doc18), make_pair("19", doc19), make_pair("20", doc20)};

TFIDF::iterator TFIDF::iterator::operator++() {
    if (cursor == parent->buffer.end())
        goto fillup;
    else if (++cursor == parent->buffer.end())
        goto fillup;
    else
        goto done;

fillup : {
    std::vector<pEdge> copy = parent->buffer;
    parent->buffer.clear();
    for (int j = 10; j < copy.size(); j++) {
        parent->buffer.push_back(copy[j]);
    }
    copy.clear();
    parent->update(10);
    cursor = parent->buffer.begin();
}
done : { return *this; }
}

TFIDF::pEdge TFIDF::iterator::operator*() const { return *cursor; }

TFIDF::iterator TFIDF::begin() {
    iterator it(this);
    return it;
}

TFIDF::iterator TFIDF::end() {
    iterator it(this);
    return it;
}

// convert a string in a vector of words
std::vector<std::string> TFIDF::textParse(const std::string &summary) {
    std::vector<std::string> vec;
    boost::tokenizer<> tok(summary);
    for (boost::tokenizer<>::iterator beg = tok.begin(); beg != tok.end(); ++beg) {
        std::string str = *beg;
        for (int i = 0; i < str.size(); i++) {
            str[i] = std::tolower(str[i]); // put all in lowercase
        }
        vec.push_back(str);
    }
    return vec;
}

void TFIDF::convertsum(const std::vector<std::string> &parsed_sum) {
    std::vector<double> OccVec(vocab.size(),
                               0); // array that stores the number of occurences of a word
    for (std::string word : parsed_sum) {
        if (vocab.find(word) ==
            vocab
                .end()) { // if it is the first time we encounter the word then insert it in the map
            vocab.insert(std::pair<std::string, int>(
                word, counter)); // a map that associates to each word an integer
            OccVec.push_back(1);
            counter++;
        } else {
            OccVec[vocab[word]] += 1;
        }
    }
    Occ2d.push_back(OccVec);
    OccVec.clear();
}

void TFIDF::createOccMat() {
    nrow = Occ2d.size();
    ncol = vocab.size();
    OccMat.resize(nrow, ncol);
    for (int i = 0; i < nrow; ++i) {
        Occ2d[i].resize(ncol, 0); // they all have the same size
        Eigen::Map<Eigen::VectorXd> vec(Occ2d[i].data(), Occ2d[i].size());
        OccMat.row(i) = vec;
    }
}

void TFIDF::createCountDoc() {
    Eigen::MatrixXd dataMat(OccMat); // copy OccMat
    CountDoc = Eigen::VectorXd::Zero(ncol);
    for (unsigned int i = 0; i < nrow; ++i) {
        for (unsigned int j = 0; j < ncol; ++j) {
            if (dataMat(i, j) >= 1) { // only keep 1 and 0
                dataMat(i, j) = 1;
            } // if the word appears in the doc put 1 otherwise : 0
        }
    }
    for (unsigned int i = 0; i < nrow; ++i) {
        CountDoc += dataMat.row(i); // sum up the columns
    }
    dataMat.resize(0, 0);
}

void TFIDF::calweightMat() {
    createOccMat();
    createCountDoc();
    weightMat.resize(nrow, ncol);
    Eigen::MatrixXd tf = Eigen::MatrixXd::Zero(nrow, ncol);
    Eigen::MatrixXd idf = Eigen::MatrixXd::Zero(ncol, ncol);
    for (unsigned int j = 0; j < ncol; ++j) {
        idf(j, j) = log(double(nrow) / (CountDoc(j)));
    }
    for (unsigned int i = 0; i < nrow; ++i) {
        tf.row(i) = OccMat.row(i) * (1 / OccMat.row(i).sum());
    }
    weightMat = tf * idf;
}

void TFIDF::update(int threshold) {
    std::vector<std::pair<std::string, std::string>> summaries = source;
    for (std::vector<std::pair<std::string, std::string>>::iterator it = summaries.begin();
         it != summaries.end(); it++) {

        if (papers.find(it->first) == papers.end()) { // replace first by id
            papers.insert(it->first);
            std::vector<std::string> parsed_abstract =
                textParse(it->second); // replace second by summary
            convertsum(parsed_abstract);
        }
        if (papers.size() > threshold) {
            break;
        }
    }
    calweightMat();
    int i = 0;
    for (std::unordered_set<std::string>::iterator it1 = papers.begin(); it1 != papers.end();
         it1++) {
        int j = 0;
        for (std::map<std::string, int>::iterator it2 = vocab.begin(); it2 != vocab.end(); it2++) {
            pEdge edge = std::make_tuple(it2->first, *it1, weightMat(i, j));
            buffer.push_back(edge);
            j++;
        }
        i++;
    }
}